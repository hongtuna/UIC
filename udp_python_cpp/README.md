cpp code only for MAC
